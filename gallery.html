<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Art Gallery — Ice</title>
  <link rel="stylesheet" href="style.css">
</head>
<body class="loaded">
  <div class="site">
    <header class="site-header">
      <div class="container">
        <div class="logo">Ice Olpindo</div>
        <nav>
          <a href="index.html">Home</a>
          <a href="view-my-work.html">View My Work</a>
          <a href="gallery.html">Gallery</a>
          <a href="#contact">Contact</a>
        </nav>
      </div>
    </header>

    <main>
      <section class="portfolio reveal gallery-page" id="gallery">
        <div class="container">
          <h2 class="section-title">Art Gallery</h2>
          <p class="muted">Selected works - click any image to view larger with captions.</p>

          <!-- START: Big Carousel -->
          <section class="gallery-carousel reveal" aria-roledescription="carousel" aria-label="Featured artwork carousel">
            <div class="carousel" role="region">
              <button class="carousel-btn prev" aria-label="Previous">‹</button>
              <div class="carousel-track-wrap">
                <ul class="carousel-track">
                  <li class="carousel-slide">
                    <img src="./assets/images/artist/art1.jpg" alt="Art 1 — Apple" data-caption="Art 1 — Apple">
                  </li>
                  <li class="carousel-slide">
                    <img src="./assets/images/artist/art2.jpg" alt="Art 2 — Stargaze" data-caption="Art 2 — Stargaze">
                  </li>
                  <li class="carousel-slide">
                    <img src="./assets/images/artist/art3.jpg" alt="Art 3 — The Crimson Tree" data-caption="Art 3 — The Crimson Tree">
                  </li>
                  <li class="carousel-slide">
                    <img src="./assets/images/artist/art4.jpg" alt="Art 4 — Conflicted" data-caption="Art 4 — Conflicted">
                  </li>
                </ul>
              </div>
              <button class="carousel-btn next" aria-label="Next">›</button>
              <div class="carousel-dots" aria-hidden="false"></div>
            </div>
          </section>
          <!-- END: Big Carousel -->

          <div class="gallery-grid">
            <!-- Add your images into assets/images/artist/ (art1.jpg..art8.jpg) -->
            <button class="gallery-item" data-src="./assets/images/artist/art1.jpg" data-caption="Art 1 — Apple">
              <img src="./assets/images/artist/art1.jpg" alt="Art 1">
            </button>
            <button class="gallery-item" data-src="./assets/images/artist/art2.jpg" data-caption="Art 2 — Stargaze">
              <img src="./assets/images/artist/art2.jpg" alt="Art 2">
            </button>
            <button class="gallery-item" data-src="./assets/images/artist/art3.jpg" data-caption="Art 3 — The Crimson Tree">
              <img src="./assets/images/artist/art3.jpg" alt="Art 3">
            </button>
            <button class="gallery-item" data-src="./assets/images/artist/art4.jpg" data-caption="Art 4 — Conflicted">
              <img src="./assets/images/artist/art4.jpg" alt="Art 4">
            </button>
            <button class="gallery-item" data-src="./assets/images/artist/art5.jpg" data-caption="Art 5 — MAGD Banner">
              <img src="./assets/images/artist/art5.jpg" alt="Art 5">
            </button>
            <button class="gallery-item" data-src="./assets/images/artist/art6.jpg" data-caption="Art 6 — CPE Banner">
              <img src="./assets/images/artist/art6.jpg" alt="Art 6">
            </button>
            <!-- add more as needed -->
          </div>
        </div>
      </section>
    </main>

    <footer id="contact">
      <div class="container">
        <p class="muted">&copy; 2025 Ice Olpindo. All rights reserved.</p>
      </div>
    </footer>
  </div> <!-- .site -->

  <!-- Lightbox markup (insert this before the script) -->
  <div id="lightbox" class="lightbox" aria-hidden="true" tabindex="-1" role="dialog" aria-label="Image viewer">
    <button class="lightbox-close" aria-label="Close">✕</button>
    <button class="lightbox-prev" aria-label="Previous">‹</button>
    <button class="lightbox-next" aria-label="Next">›</button>
    <img class="lightbox-img" src="" alt="">
    <div class="lightbox-caption" aria-live="polite"></div>
  </div>

  <!-- Lightbox + reveal + carousel script -->
  <script>
  (function () {
    // markLoaded & reveal-on-scroll (existing behavior)
    const reveals = Array.from(document.querySelectorAll('.reveal'));
    if ('IntersectionObserver' in window && reveals.length) {
      const io = new IntersectionObserver((entries, obs) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('is-visible');
            obs.unobserve(entry.target);
          }
        });
      }, { threshold: 0.12 });
      reveals.forEach(el => io.observe(el));
    } else {
      reveals.forEach(el => el.classList.add('is-visible'));
    }

    /* ---------- Carousel ---------- */
    const carouselEl = document.querySelector('.gallery-carousel .carousel');
    if (carouselEl) {
      const track = carouselEl.querySelector('.carousel-track');
      const slides = Array.from(track.querySelectorAll('.carousel-slide'));
      const prevBtn = carouselEl.querySelector('.carousel-btn.prev');
      const nextBtn = carouselEl.querySelector('.carousel-btn.next');
      const dotsWrap = carouselEl.querySelector('.carousel-dots');
      let current = 0;
      let autoplay = true;
      let timer = null;
      const AUTOPLAY_MS = 4200;

      // create dots
      slides.forEach((_, i) => {
        const d = document.createElement('button');
        d.className = 'dot';
        d.setAttribute('aria-label', 'Go to slide ' + (i+1));
        d.addEventListener('click', () => goTo(i));
        dotsWrap.appendChild(d);
      });
      const dots = Array.from(dotsWrap.querySelectorAll('.dot'));

      function update() {
        const w = carouselEl.querySelector('.carousel-track-wrap').offsetWidth;
        track.style.transform = `translateX(-${current * w}px)`;
        slides.forEach((s, i) => s.setAttribute('aria-hidden', i !== current));
        dots.forEach((d, i) => d.classList.toggle('active', i === current));
      }

      function goTo(i) {
        current = (i + slides.length) % slides.length;
        update();
        resetAutoplay();
      }
      function next() { goTo(current + 1); }
      function prev() { goTo(current - 1); }

      nextBtn.addEventListener('click', next);
      prevBtn.addEventListener('click', prev);

      // keyboard
      carouselEl.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowRight') next();
        if (e.key === 'ArrowLeft') prev();
      });

      // swipe support
      let startX = 0, dist = 0, isTouch = false;
      const wrap = carouselEl.querySelector('.carousel-track-wrap');
      wrap.addEventListener('pointerdown', (e) => {
        isTouch = true; startX = e.clientX; wrap.setPointerCapture(e.pointerId);
      });
      wrap.addEventListener('pointermove', (e) => {
        if (!isTouch) return;
        dist = e.clientX - startX;
      });
      wrap.addEventListener('pointerup', () => {
        if (Math.abs(dist) > 40) { if (dist < 0) next(); else prev(); }
        isTouch = false; dist = 0;
      });

      // autoplay
      function resetAutoplay() {
        if (!autoplay) return;
        clearTimeout(timer);
        timer = setTimeout(next, AUTOPLAY_MS);
      }
      // responsive resize
      window.addEventListener('resize', update);

      // init
      update();
      resetAutoplay();

      // clicking a slide opens lightbox (if available)
      slides.forEach((s, i) => {
        s.addEventListener('click', () => {
          const img = s.querySelector('img');
          const src = img?.dataset.src || img?.src;
          const caption = img?.dataset?.caption || img?.alt || '';
          const lb = document.getElementById('lightbox');
          if (lb) {
            // reuse lightbox open logic below by simulating click on corresponding gallery-item if exists
            // fallback: open image directly
            const lbImg = lb.querySelector('.lightbox-img');
            const lbCaption = lb.querySelector('.lightbox-caption');
            lbImg.src = src || '';
            lbCaption.textContent = caption;
            lb.classList.add('open');
            lb.setAttribute('aria-hidden','false');
            document.body.style.overflow = 'hidden';
            lb.querySelector('.lightbox-close')?.focus();
          } else if (src) {
            window.open(src, '_blank');
          }
        });
      });
    }

    /* ---------- Lightbox (existing) ---------- */
    const items = Array.from(document.querySelectorAll('.gallery-item'));
    if (!items.length) return;

    const lb = document.getElementById('lightbox');
    if (lb) {
      const lbImg = lb.querySelector('.lightbox-img');
      const lbCaption = lb.querySelector('.lightbox-caption');
      const closeBtn = lb.querySelector('.lightbox-close');
      const prevBtn = lb.querySelector('.lightbox-prev');
      const nextBtn = lb.querySelector('.lightbox-next');
      let idx = -1;

      function open(i){
        const el = items[i];
        if(!el) return;
        idx = i;
        const src = el.dataset.src || el.querySelector('img')?.src;
        const caption = el.dataset.caption || '';
        lbImg.src = src || '';
        lbImg.alt = el.querySelector('img')?.alt || '';
        lbCaption.textContent = caption;
        lb.classList.add('open');
        lb.setAttribute('aria-hidden','false');
        document.body.style.overflow = 'hidden';
        closeBtn.focus();
      }
      function close(){
        lb.classList.remove('open');
        lb.setAttribute('aria-hidden','true');
        lbImg.src = '';
        document.body.style.overflow = '';
        const thumb = items[idx];
        if (thumb) thumb.focus();
      }
      function prev(){ if(idx>0) open(idx-1); }
      function next(){ if(idx < items.length-1) open(idx+1); }

      items.forEach((it,i)=>{
        it.setAttribute('aria-pressed','false');
        it.addEventListener('click', ()=> open(i));
        it.addEventListener('keydown', (e)=> { if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); open(i); } });
      });

      closeBtn.addEventListener('click', close);
      prevBtn.addEventListener('click', prev);
      nextBtn.addEventListener('click', next);
      lb.addEventListener('click', (e)=> { if(e.target === lb) close(); });

      document.addEventListener('keydown', (e)=>{
        if(!lb.classList.contains('open')) return;
        if(e.key === 'Escape') close();
        if(e.key === 'ArrowLeft') prev();
        if(e.key === 'ArrowRight') next();
      });
    } else {
      items.forEach(it => {
        it.addEventListener('click', () => {
          const src = it.dataset.src || it.querySelector('img')?.src;
          if (src) window.open(src, '_blank');
        });
        it.addEventListener('keydown', (e) => { if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); const src = it.dataset.src || it.querySelector('img')?.src; if (src) window.open(src, '_blank'); }});
      });
    }
  })();
  </script>
</body>
</html>
